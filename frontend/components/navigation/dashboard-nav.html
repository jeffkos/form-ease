<!-- 
  NAVIGATION DASHBOARD - Pour les pages authentifiées
  Usage: Dashboard, formulaires, analytics, profil
-->
<nav class="tremor-Card sticky top-0 z-40 border-0 border-b border-tremor-border-default">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            
            <!-- Logo et navigation principale -->
            <div class="flex items-center space-x-8">
                <a href="/dashboard/home.html" class="flex items-center space-x-2 group">
                    <div class="w-8 h-8 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center group-hover:scale-105 transition-transform">
                        <i class="ri-file-text-line text-white text-lg"></i>
                    </div>
                    <span class="tremor-Title text-tremor-content-strong">FormEase</span>
                </a>
                
                <!-- Navigation desktop -->
                <div class="hidden lg:flex items-center space-x-6">
                    <a href="/dashboard/home.html" class="nav-link" data-page="dashboard">
                        <i class="ri-dashboard-line"></i>
                        <span>Tableau de bord</span>
                    </a>
                    <a href="/forms/list.html" class="nav-link" data-page="forms">
                        <i class="ri-file-list-line"></i>
                        <span>Mes formulaires</span>
                    </a>
                    <a href="/analytics/dashboard.html" class="nav-link" data-page="analytics">
                        <i class="ri-line-chart-line"></i>
                        <span>Analytics</span>
                    </a>
                    <a href="/responses/manager.html" class="nav-link" data-page="responses">
                        <i class="ri-message-2-line"></i>
                        <span>Réponses</span>
                    </a>
                </div>
            </div>
            
            <!-- Actions et profil -->
            <div class="flex items-center space-x-4">
                
                <!-- Bouton de création rapide -->
                <div class="relative">
                    <button 
                        onclick="toggleCreateMenu()" 
                        class="tremor-Button tremor-Button-primary tremor-Button-sm"
                        aria-label="Créer un formulaire"
                    >
                        <i class="ri-add-line"></i>
                        <span class="hidden sm:inline">Créer</span>
                        <i class="ri-arrow-down-s-line ml-1"></i>
                    </button>
                    
                    <!-- Menu de création -->
                    <div id="create-menu" class="hidden absolute right-0 mt-2 w-56 tremor-Card shadow-lg z-50">
                        <div class="py-1">
                            <a href="/forms/ai-generator.html" class="flex items-center px-4 py-2 tremor-Text hover:bg-tremor-background-subtle transition-colors">
                                <i class="ri-robot-line mr-3 text-blue-600"></i>
                                Générer par IA
                            </a>
                            <a href="/forms/builder.html" class="flex items-center px-4 py-2 tremor-Text hover:bg-tremor-background-subtle transition-colors">
                                <i class="ri-edit-box-line mr-3 text-green-600"></i>
                                Créer manuellement
                            </a>
                            <hr class="my-1 border-tremor-border-default">
                            <a href="/forms/list.html?template=true" class="flex items-center px-4 py-2 tremor-Text hover:bg-tremor-background-subtle transition-colors">
                                <i class="ri-file-copy-line mr-3 text-purple-600"></i>
                                Depuis un modèle
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Notifications -->
                <button 
                    onclick="toggleNotifications()" 
                    class="tremor-Button tremor-Button-ghost tremor-Button-sm relative"
                    aria-label="Notifications"
                >
                    <i class="ri-notification-line"></i>
                    <span id="notification-badge" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">
                        3
                    </span>
                </button>
                
                <!-- Profil utilisateur -->
                <div class="relative">
                    <button 
                        onclick="toggleProfileMenu()" 
                        class="flex items-center space-x-2 tremor-Button tremor-Button-ghost tremor-Button-sm"
                        aria-label="Profil utilisateur"
                    >
                        <div class="w-8 h-8 bg-gradient-to-br from-gray-400 to-gray-600 rounded-full flex items-center justify-center">
                            <i class="ri-user-line text-white"></i>
                        </div>
                        <span class="hidden sm:inline tremor-Text" id="user-name">Utilisateur</span>
                        <i class="ri-arrow-down-s-line"></i>
                    </button>
                    
                    <!-- Menu profil -->
                    <div id="profile-menu" class="hidden absolute right-0 mt-2 w-56 tremor-Card shadow-lg z-50">
                        <div class="py-1">
                            <div class="px-4 py-2 border-b border-tremor-border-default">
                                <p class="tremor-Text text-xs text-tremor-content-subtle">Connecté en tant que</p>
                                <p class="tremor-Subtitle" id="user-email">user@example.com</p>
                            </div>
                            <a href="/dashboard/profile.html" class="flex items-center px-4 py-2 tremor-Text hover:bg-tremor-background-subtle transition-colors">
                                <i class="ri-user-settings-line mr-3"></i>
                                Mon profil
                            </a>
                            <a href="/utils/help.html" class="flex items-center px-4 py-2 tremor-Text hover:bg-tremor-background-subtle transition-colors">
                                <i class="ri-question-line mr-3"></i>
                                Aide
                            </a>
                            <hr class="my-1 border-tremor-border-default">
                            <button 
                                onclick="Auth.logout()" 
                                class="w-full flex items-center px-4 py-2 tremor-Text hover:bg-tremor-background-subtle transition-colors text-left"
                            >
                                <i class="ri-logout-box-line mr-3"></i>
                                Déconnexion
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Menu mobile -->
                <div class="lg:hidden">
                    <button 
                        onclick="toggleMobileMenu()" 
                        class="tremor-Button tremor-Button-ghost tremor-Button-sm"
                        aria-label="Menu"
                    >
                        <i class="ri-menu-line text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Menu mobile -->
    <div id="mobile-menu" class="hidden lg:hidden border-t border-tremor-border-default bg-tremor-background-default">
        <div class="px-4 py-3 space-y-3">
            <a href="/dashboard/home.html" class="flex items-center space-x-3 tremor-Text hover:text-tremor-content-emphasis transition-colors">
                <i class="ri-dashboard-line"></i>
                <span>Tableau de bord</span>
            </a>
            <a href="/forms/list.html" class="flex items-center space-x-3 tremor-Text hover:text-tremor-content-emphasis transition-colors">
                <i class="ri-file-list-line"></i>
                <span>Mes formulaires</span>
            </a>
            <a href="/analytics/dashboard.html" class="flex items-center space-x-3 tremor-Text hover:text-tremor-content-emphasis transition-colors">
                <i class="ri-line-chart-line"></i>
                <span>Analytics</span>
            </a>
            <a href="/responses/manager.html" class="flex items-center space-x-3 tremor-Text hover:text-tremor-content-emphasis transition-colors">
                <i class="ri-message-2-line"></i>
                <span>Réponses</span>
            </a>
        </div>
    </div>
</nav>

<style>
.nav-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--tremor-content-default);
    transition: color 0.2s;
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    text-decoration: none;
}

.nav-link:hover {
    color: var(--tremor-content-emphasis);
}

.nav-link[data-page].active {
    background-color: var(--tremor-brand-faint);
    color: var(--tremor-brand-emphasis);
}
</style>

<script>
// Gestion des menus déroulants
function toggleCreateMenu() {
    const menu = document.getElementById('create-menu');
    menu.classList.toggle('hidden');
}

function toggleNotifications() {
    // TODO: Implémenter la logique des notifications
    console.log('Notifications clicked');
}

function toggleProfileMenu() {
    const menu = document.getElementById('profile-menu');
    menu.classList.toggle('hidden');
}

function toggleMobileMenu() {
    const menu = document.getElementById('mobile-menu');
    menu.classList.toggle('hidden');
}

// Fermer les menus si on clique ailleurs
document.addEventListener('click', (e) => {
    const createMenu = document.getElementById('create-menu');
    const profileMenu = document.getElementById('profile-menu');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (!e.target.closest('[onclick="toggleCreateMenu()"]') && createMenu) {
        createMenu.classList.add('hidden');
    }
    
    if (!e.target.closest('[onclick="toggleProfileMenu()"]') && profileMenu) {
        profileMenu.classList.add('hidden');
    }
    
    if (!e.target.closest('[onclick="toggleMobileMenu()"]') && mobileMenu) {
        mobileMenu.classList.add('hidden');
    }
});

// Marquer la page active
document.addEventListener('DOMContentLoaded', () => {
    const currentPage = window.location.pathname;
    const navLinks = document.querySelectorAll('.nav-link[data-page]');
    
    navLinks.forEach(link => {
        if (currentPage.includes(link.dataset.page)) {
            link.classList.add('active');
        }
    });
    
    // Charger les informations utilisateur
    if (FormEase.state.user) {
        const userNameEl = document.getElementById('user-name');
        const userEmailEl = document.getElementById('user-email');
        
        if (userNameEl) userNameEl.textContent = FormEase.state.user.name || 'Utilisateur';
        if (userEmailEl) userEmailEl.textContent = FormEase.state.user.email || '';
    }
});
</script>
