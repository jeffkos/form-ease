<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mes Formulaires - FormEase</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.0.0/fonts/remixicon.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <!-- FormEase Functions -->
    <script src="../../../formease-functions.js"></script>
    <!-- FormEase Functions -->
    <script src="../../formease-functions.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        tremor: {
                            brand: {
                                faint: '#f0f9ff',
                                muted: '#bae6fd',
                                subtle: '#38bdf8',
                                DEFAULT: '#0ea5e9',
                                emphasis: '#0284c7',
                                inverted: '#ffffff'
                            },
                            content: {
                                strong: '#0f172a',
                                emphasis: '#334155',
                                DEFAULT: '#64748b',
                                subtle: '#94a3b8',
                                inverted: '#ffffff'
                            },
                            background: {
                                muted: '#f8fafc',
                                subtle: '#f1f5f9',
                                DEFAULT: '#ffffff'
                            }
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'ui-sans-serif', 'system-ui'],
                    },
                }
            }
        }
    </script>
    
    <style>
        .tremor-Card {
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.95);
            border-radius: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .tremor-Card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .tremor-Button {
            background: #2563eb;
            transition: all 0.2s ease;
        }
        .tremor-Button:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }
        .form-card {
            transition: all 0.3s ease;
        }
        .form-card:hover {
            transform: translateY(-4px);
        }
        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .status-active {
            background-color: #dcfce7;
            color: #166534;
        }
        .status-draft {
            background-color: #fef3c7;
            color: #92400e;
        }
        .status-archived {
            background-color: #f3f4f6;
            color: #374151;
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Navigation -->
    <nav class="border-b border-gray-200 bg-white/95 backdrop-blur-md fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="../dashboard/home.html" class="flex-shrink-0 flex items-center hover:opacity-80 transition-opacity">
                        <i class="ri-form-line text-2xl text-tremor-brand-DEFAULT mr-2"></i>
                        <span class="text-xl font-bold text-tremor-content-strong">FormEase</span>
                    </a>
                    <div class="hidden md:ml-10 md:flex md:space-x-8">
                        <a href="../dashboard/home.html" class="text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT transition-colors">
                            Tableau de bord
                        </a>
                        <a href="management.html" class="text-tremor-brand-DEFAULT font-medium">
                            Mes formulaires
                        </a>
                        <a href="../analytics/dashboard.html" class="text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT transition-colors">
                            Analytics
                        </a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button class="p-2 text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT">
                            <i class="ri-notification-line text-xl"></i>
                        </button>
                    </div>
                    <div class="relative">
                        <button class="flex items-center space-x-2 text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT">
                            <div class="w-8 h-8 bg-tremor-brand-DEFAULT rounded-full flex items-center justify-center">
                                <i class="ri-user-line text-white"></i>
                            </div>
                            <span class="hidden md:block">Mon compte</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="pt-20 pb-8 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8">
                <div>
                    <h1 class="text-3xl font-bold text-tremor-content-strong mb-2">
                        Mes Formulaires
                    </h1>
                    <p class="text-tremor-content-DEFAULT">
                        Gérez et organisez tous vos formulaires en un seul endroit
                    </p>
                </div>
                <div class="flex space-x-3 mt-4 md:mt-0">
                    <a href="../forms/ai-generator.html" class="tremor-Button inline-flex items-center px-4 py-2 rounded-lg text-white font-medium">
                        <i class="ri-magic-line mr-2"></i>
                        IA Generator
                    </a>
                    <a href="file:///C:/Users/Jeff%20KOSI/Desktop/FormEase/frontend/pages/forms/builder.html" class="bg-gray-100 hover:bg-gray-200 text-tremor-content-strong inline-flex items-center px-4 py-2 rounded-lg font-medium transition-colors">
                        <i class="ri-add-line mr-2"></i>
                        Nouveau formulaire
                    </a>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="tremor-Card p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-tremor-content-DEFAULT text-sm">Total formulaires</p>
                            <p class="text-2xl font-bold text-tremor-content-strong">12</p>
                        </div>
                        <div class="h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="ri-file-list-line text-blue-600"></i>
                        </div>
                    </div>
                </div>
                
                <div class="tremor-Card p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-tremor-content-DEFAULT text-sm">Réponses ce mois</p>
                            <p class="text-2xl font-bold text-tremor-content-strong">2,847</p>
                        </div>
                        <div class="h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="ri-chat-3-line text-green-600"></i>
                        </div>
                    </div>
                </div>
                
                <div class="tremor-Card p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-tremor-content-DEFAULT text-sm">Taux de conversion</p>
                            <p class="text-2xl font-bold text-tremor-content-strong">68%</p>
                        </div>
                        <div class="h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="ri-trending-up-line text-purple-600"></i>
                        </div>
                    </div>
                </div>
                
                <div class="tremor-Card p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-tremor-content-DEFAULT text-sm">Formulaires actifs</p>
                            <p class="text-2xl font-bold text-tremor-content-strong">8</p>
                        </div>
                        <div class="h-12 w-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                            <i class="ri-play-circle-line text-yellow-600"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Filters and Search -->
    <section class="pb-6 bg-white border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0">
                <!-- Search -->
                <div class="relative flex-1 max-w-md">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="ri-search-line text-tremor-content-subtle"></i>
                    </div>
                    <input type="text" placeholder="Rechercher un formulaire..."
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-tremor-brand-DEFAULT focus:border-tremor-brand-DEFAULT">
                </div>

                <!-- Filters -->
                <div class="flex space-x-4">
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-tremor-brand-DEFAULT focus:border-tremor-brand-DEFAULT">
                        <option>Tous les statuts</option>
                        <option>Actif</option>
                        <option>Brouillon</option>
                        <option>Archivé</option>
                    </select>
                    
                    <select class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-tremor-brand-DEFAULT focus:border-tremor-brand-DEFAULT">
                        <option>Trier par</option>
                        <option>Date de création</option>
                        <option>Dernière modification</option>
                        <option>Nombre de réponses</option>
                        <option>Nom A-Z</option>
                    </select>

                    <button class="p-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                        <i class="ri-filter-line text-tremor-content-DEFAULT"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Forms Grid -->
    <section class="py-8 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                
                <!-- Form Card 1 -->
                <div class="tremor-Card p-6 form-card">
                    <div class="flex justify-between items-start mb-4">
                        <span class="status-badge status-active">
                            <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                            Actif
                        </span>
                        <div class="relative">
                            <button class="p-1 hover:bg-gray-100 rounded" onclick="toggleDropdown('form1')">
                                <i class="ri-more-line text-tremor-content-DEFAULT"></i>
                            </button>
                            <div id="form1" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10">
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Modifier</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Dupliquer</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Partager</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Analytics</a>
                                <div class="border-t border-gray-100"></div>
                                <a href="#" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-50">Supprimer</a>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-semibold text-tremor-content-strong mb-2">
                        Formulaire de Contact
                    </h3>
                    <p class="text-tremor-content-DEFAULT text-sm mb-4">
                        Formulaire de contact principal pour le site web
                    </p>
                    
                    <div class="flex items-center justify-between text-sm text-tremor-content-subtle mb-4">
                        <span>Créé le 15 jan 2025</span>
                        <span>Modifié il y a 2h</span>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 mb-4">
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">1,247</p>
                            <p class="text-xs text-tremor-content-subtle">Vues</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">321</p>
                            <p class="text-xs text-tremor-content-subtle">Réponses</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">26%</p>
                            <p class="text-xs text-tremor-content-subtle">Taux</p>
                        </div>
                    </div>
                    
                    <div class="flex space-x-2 mb-3">
                        <a href="file:///C:/Users/Jeff%20KOSI/Desktop/FormEase/frontend/pages/forms/builder.html" class="flex-1 tremor-Button text-center py-2 px-4 rounded-lg text-white text-sm">
                            Modifier
                        </a>
                        <button onclick="viewForm('form-1', 'Formulaire de Contact')" class="flex-1 bg-blue-100 hover:bg-blue-200 text-blue-700 text-center py-2 px-4 rounded-lg text-sm transition-colors">
                            Visualiser
                        </button>
                        </button>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="viewResponses('form-1', 'Formulaire de Contact', 321)" class="flex-1 bg-green-100 hover:bg-green-200 text-green-700 text-center py-2 px-3 rounded-lg text-sm transition-colors">
                            <i class="ri-file-list-line mr-1"></i>Réponses (321)
                        </button>
                        <button onclick="shareForm('form-1', 'Formulaire de Contact')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="Partager">
                            <i class="ri-share-line text-tremor-content-DEFAULT"></i>
                        </button>
                        <button onclick="showAnalytics('form-1', 'Formulaire de Contact')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="Analytics">
                            <i class="ri-bar-chart-line text-tremor-content-DEFAULT"></i>
                        </button>
                        <button onclick="showQRCode('form-1', 'Formulaire de Contact')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="QR Code">
                            <i class="ri-qr-code-line text-tremor-content-DEFAULT"></i>
                        </button>
                    </div>
                </div>

                <!-- Form Card 2 -->
                <div class="tremor-Card p-6 form-card">
                    <div class="flex justify-between items-start mb-4">
                        <span class="status-badge status-draft">
                            <div class="w-2 h-2 bg-yellow-500 rounded-full mr-2"></div>
                            Brouillon
                        </span>
                        <div class="relative">
                            <button class="p-1 hover:bg-gray-100 rounded" onclick="toggleDropdown('form2')">
                                <i class="ri-more-line text-tremor-content-DEFAULT"></i>
                            </button>
                            <div id="form2" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10">
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Modifier</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Publier</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Dupliquer</a>
                                <div class="border-t border-gray-100"></div>
                                <a href="#" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-50">Supprimer</a>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-semibold text-tremor-content-strong mb-2">
                        Sondage Satisfaction Client
                    </h3>
                    <p class="text-tremor-content-DEFAULT text-sm mb-4">
                        Évaluation de la satisfaction après achat
                    </p>
                    
                    <div class="flex items-center justify-between text-sm text-tremor-content-subtle mb-4">
                        <span>Créé le 10 jan 2025</span>
                        <span>Modifié il y a 1j</span>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 mb-4">
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">-</p>
                            <p class="text-xs text-tremor-content-subtle">Vues</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">-</p>
                            <p class="text-xs text-tremor-content-subtle">Réponses</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">-</p>
                            <p class="text-xs text-tremor-content-subtle">Taux</p>
                        </div>
                    </div>
                    
                    <div class="flex space-x-2 mb-3">
                        <a href="file:///C:/Users/Jeff%20KOSI/Desktop/FormEase/frontend/pages/forms/builder.html" class="flex-1 tremor-Button text-center py-2 px-4 rounded-lg text-white text-sm">
                            Continuer
                        </a>
                        <button onclick="viewForm('form-2', 'Sondage Satisfaction Client')" class="flex-1 bg-blue-100 hover:bg-blue-200 text-blue-700 text-center py-2 px-4 rounded-lg text-sm transition-colors">
                            Visualiser
                        </button>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="viewResponses('form-2', 'Sondage Satisfaction Client', 0)" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-600 text-center py-2 px-3 rounded-lg text-sm transition-colors">
                            <i class="ri-file-list-line mr-1"></i>Réponses (0)
                        </button>
                        <button onclick="shareForm('form-2', 'Sondage Satisfaction Client')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="Partager">
                            <i class="ri-share-line text-tremor-content-DEFAULT"></i>
                        </button>
                        <button onclick="showAnalytics('form-2', 'Sondage Satisfaction Client')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="Analytics">
                            <i class="ri-bar-chart-line text-tremor-content-DEFAULT"></i>
                        </button>
                        <button onclick="showQRCode('form-2', 'Sondage Satisfaction Client')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="QR Code">
                            <i class="ri-qr-code-line text-tremor-content-DEFAULT"></i>
                        </button>
                    </div>
                </div>

                <!-- Form Card 3 -->
                <div class="tremor-Card p-6 form-card">
                    <div class="flex justify-between items-start mb-4">
                        <span class="status-badge status-active">
                            <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                            Actif
                        </span>
                        <div class="relative">
                            <button class="p-1 hover:bg-gray-100 rounded" onclick="toggleDropdown('form3')">
                                <i class="ri-more-line text-tremor-content-DEFAULT"></i>
                            </button>
                            <div id="form3" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10">
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Modifier</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Dupliquer</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Partager</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Analytics</a>
                                <div class="border-t border-gray-100"></div>
                                <a href="#" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-50">Supprimer</a>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-semibold text-tremor-content-strong mb-2">
                        Inscription Événement
                    </h3>
                    <p class="text-tremor-content-DEFAULT text-sm mb-4">
                        Formulaire d'inscription pour notre prochain webinar
                    </p>
                    
                    <div class="flex items-center justify-between text-sm text-tremor-content-subtle mb-4">
                        <span>Créé le 8 jan 2025</span>
                        <span>Modifié il y a 3h</span>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 mb-4">
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">856</p>
                            <p class="text-xs text-tremor-content-subtle">Vues</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">127</p>
                            <p class="text-xs text-tremor-content-subtle">Réponses</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">15%</p>
                            <p class="text-xs text-tremor-content-subtle">Taux</p>
                        </div>
                    </div>
                    
                    <div class="flex space-x-2 mb-3">
                        <a href="file:///C:/Users/Jeff%20KOSI/Desktop/FormEase/frontend/pages/forms/builder.html" class="flex-1 tremor-Button text-center py-2 px-4 rounded-lg text-white text-sm">
                            Modifier
                        </a>
                        <button onclick="viewForm('form-3', 'Inscription Événement')" class="flex-1 bg-blue-100 hover:bg-blue-200 text-blue-700 text-center py-2 px-4 rounded-lg text-sm transition-colors">
                            Visualiser
                        </button>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="viewResponses('form-3', 'Inscription Événement', 127)" class="flex-1 bg-green-100 hover:bg-green-200 text-green-700 text-center py-2 px-3 rounded-lg text-sm transition-colors">
                            <i class="ri-file-list-line mr-1"></i>Inscrits (127)
                        </button>
                        <button onclick="shareForm('form-3', 'Inscription Événement')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="Partager">
                            <i class="ri-share-line text-tremor-content-DEFAULT"></i>
                        </button>
                        <button onclick="showAnalytics('form-3', 'Inscription Événement')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="Analytics">
                            <i class="ri-bar-chart-line text-tremor-content-DEFAULT"></i>
                        </button>
                        <button onclick="showQRCode('form-3', 'Inscription Événement')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="QR Code">
                            <i class="ri-qr-code-line text-tremor-content-DEFAULT"></i>
                        </button>
                    </div>
                </div>

                <!-- Form Card 4 -->
                <div class="tremor-Card p-6 form-card">
                    <div class="flex justify-between items-start mb-4">
                        <span class="status-badge status-archived">
                            <div class="w-2 h-2 bg-gray-500 rounded-full mr-2"></div>
                            Archivé
                        </span>
                        <div class="relative">
                            <button class="p-1 hover:bg-gray-100 rounded" onclick="toggleDropdown('form4')">
                                <i class="ri-more-line text-tremor-content-DEFAULT"></i>
                            </button>
                            <div id="form4" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-10">
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Restaurer</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Dupliquer</a>
                                <a href="#" class="block px-4 py-2 text-sm hover:bg-gray-50">Exporter données</a>
                                <div class="border-t border-gray-100"></div>
                                <a href="#" class="block px-4 py-2 text-sm text-red-600 hover:bg-gray-50">Supprimer définitivement</a>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="text-lg font-semibold text-tremor-content-strong mb-2">
                        Feedback Produit Q4
                    </h3>
                    <p class="text-tremor-content-DEFAULT text-sm mb-4">
                        Collecte de retours sur nos nouvelles fonctionnalités
                    </p>
                    
                    <div class="flex items-center justify-between text-sm text-tremor-content-subtle mb-4">
                        <span>Créé le 1 déc 2024</span>
                        <span>Archivé le 5 jan 2025</span>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 mb-4">
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">2,154</p>
                            <p class="text-xs text-tremor-content-subtle">Vues</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">573</p>
                            <p class="text-xs text-tremor-content-subtle">Réponses</p>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-bold text-tremor-content-strong">27%</p>
                            <p class="text-xs text-tremor-content-subtle">Taux</p>
                        </div>
                    </div>
                    
                    <div class="flex space-x-2">
                        <button onclick="restoreForm('form-4', 'Feedback Produit Q4')" class="flex-1 bg-gray-100 hover:bg-gray-200 text-center py-2 px-4 rounded-lg text-tremor-content-strong text-sm transition-colors">
                            Restaurer
                        </button>
                        <button onclick="exportFormData('form-4', 'Feedback Produit Q4')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="Exporter les données">
                            <i class="ri-download-line text-tremor-content-DEFAULT"></i>
                        </button>
                        <button onclick="showQRCode('form-4', 'Feedback Produit Q4')" class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors" title="QR Code">
                            <i class="ri-qr-code-line text-tremor-content-DEFAULT"></i>
                        </button>
                    </div>
                </div>

                <!-- Empty State for more forms -->
                <div class="tremor-Card p-8 text-center border-2 border-dashed border-gray-300">
                    <div class="h-12 w-12 bg-gray-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                        <i class="ri-add-line text-2xl text-gray-400"></i>
                    </div>
                    <h3 class="text-lg font-semibold text-tremor-content-strong mb-2">
                        Créer un nouveau formulaire
                    </h3>
                    <p class="text-tremor-content-DEFAULT text-sm mb-4">
                        Utilisez l'IA ou l'éditeur visuel pour créer votre prochain formulaire
                    </p>
                    <div class="flex flex-col space-y-2">
                        <a href="../forms/ai-generator.html" class="tremor-Button text-center py-2 px-4 rounded-lg text-white text-sm">
                            <i class="ri-magic-line mr-2"></i>
                            Avec l'IA
                        </a>
                        <a href="file:///C:/Users/Jeff%20KOSI/Desktop/FormEase/frontend/pages/forms/builder.html" class="bg-gray-100 hover:bg-gray-200 text-center py-2 px-4 rounded-lg text-tremor-content-strong text-sm transition-colors">
                            <i class="ri-edit-line mr-2"></i>
                            Manuellement
                        </a>
                    </div>
                </div>

            </div>

            <!-- Pagination -->
            <div class="flex justify-center mt-8">
                <nav class="flex space-x-2">
                    <button class="px-3 py-2 text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT disabled:opacity-50">
                        <i class="ri-arrow-left-line"></i>
                    </button>
                    <button class="px-3 py-2 bg-tremor-brand-DEFAULT text-white rounded">1</button>
                    <button class="px-3 py-2 text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT">2</button>
                    <button class="px-3 py-2 text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT">3</button>
                    <button class="px-3 py-2 text-tremor-content-DEFAULT hover:text-tremor-brand-DEFAULT">
                        <i class="ri-arrow-right-line"></i>
                    </button>
                </nav>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <i class="ri-form-line text-xl text-tremor-brand-DEFAULT"></i>
                    <span class="text-tremor-content-strong font-medium">FormEase</span>
                </div>
                <div class="flex space-x-6 text-sm text-tremor-content-subtle">
                    <a href="../utils/help.html" class="hover:text-tremor-brand-DEFAULT">Aide</a>
                    <a href="../utils/api-docs.html" class="hover:text-tremor-brand-DEFAULT">API</a>
                    <a href="../public/about.html" class="hover:text-tremor-brand-DEFAULT">À propos</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Test des fonctions de base - Debug
        console.log('Script chargé correctement');
        
        // Fonction de test
        function testFunction() {
            alert('Test fonction OK!');
        }
        
        // GESTION AVANCÉE DES RÉPONSES AVEC FILTRES ADAPTATIFS
        function viewResponses(formId, formName, responseCount) {
            console.log('viewResponses appelée avec:', formId, formName, responseCount);
            
            if (responseCount === 0) {
                showNotification(`Aucune réponse pour "${formName}"`, 'info');
                return;
            }
            
            // Données simulées des formulaires avec leurs champs spécifiques
            const formData = getFormDataStructure(formId);
            const responses = generateAdaptiveResponses(formId, responseCount);
            
            // Modal principal avec design Tremor UI
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-2xl w-full max-w-7xl h-[90vh] flex flex-col overflow-hidden">
                    <!-- Header avec gradient Tremor -->
                    <div class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 flex-shrink-0">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-4">
                                <div class="w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center">
                                    <i class="ri-file-list-3-line text-2xl"></i>
                                </div>
                                <div>
                                    <h2 class="text-xl font-semibold text-white">${formName}</h2>
                                    <p class="text-white/80 text-sm">${responseCount} réponses • Gestion intelligente</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button onclick="exportResponses('${formId}', '${formName}')" 
                                        class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200">
                                    <i class="ri-download-line mr-2"></i>Exporter
                                </button>
                                <button onclick="this.closest('.fixed').remove()" 
                                        class="bg-white/20 hover:bg-white/30 text-white w-10 h-10 rounded-lg flex items-center justify-center transition-colors duration-200">
                                    <i class="ri-close-line text-xl"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Corps principal -->
                    <div class="flex flex-1 overflow-hidden">
                        <!-- Sidebar Filtres Adaptatifs -->
                        <div class="w-80 bg-gray-50 border-r border-gray-200 p-6 overflow-y-auto flex-shrink-0">
                            <div class="mb-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-2">
                                    <i class="ri-filter-3-line mr-2 text-blue-600"></i>
                                    Filtres intelligents
                                </h3>
                                <p class="text-sm text-gray-600">Adaptés aux champs de votre formulaire</p>
                            </div>
                            
                            <div id="adaptive-filters-${formId}" class="space-y-6">
                                ${getAdaptiveFilters(formId, formData)}
                            </div>
                            
                            <div class="mt-6 pt-6 border-t border-gray-200">
                                <button onclick="resetFilters('${formId}')" 
                                        class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg text-sm font-medium transition-colors duration-200">
                                    <i class="ri-refresh-line mr-2"></i>Réinitialiser
                                </button>
                            </div>
                        </div>

                        <!-- Zone de contenu principale -->
                        <div class="flex-1 flex flex-col overflow-hidden">
                            <!-- Barre de contrôles -->
                            <div class="bg-white border-b border-gray-200 p-6 flex-shrink-0">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex items-center space-x-6">
                                        <label class="flex items-center space-x-3 cursor-pointer">
                                            <input type="checkbox" id="select-all-${formId}" 
                                                   onchange="toggleSelectAll('${formId}')"
                                                   class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2">
                                            <span class="text-sm font-medium text-gray-900">Tout sélectionner</span>
                                        </label>
                                        <span id="selection-count-${formId}" class="text-sm text-gray-600 bg-gray-100 px-3 py-1 rounded-full">
                                            0 sélectionné(s)
                                        </span>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <div class="flex items-center space-x-2">
                                            <label class="text-sm text-gray-600">Afficher:</label>
                                            <select id="per-page-${formId}" onchange="changePerPage('${formId}')"
                                                    class="bg-white border border-gray-300 rounded-lg px-3 py-1.5 text-sm text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                                <option value="10">10 par page</option>
                                                <option value="25" selected>25 par page</option>
                                                <option value="50">50 par page</option>
                                                <option value="100">100 par page</option>
                                            </select>
                                        </div>
                                        <div class="text-sm text-gray-600">
                                            <span id="total-filtered-${formId}">${responseCount}</span> réponses trouvées
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Actions en lot -->
                                <div id="bulk-actions-${formId}" class="hidden bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="flex items-center space-x-2">
                                            <i class="ri-magic-line text-blue-600"></i>
                                            <span class="text-sm font-medium text-blue-600">Actions en lot</span>
                                            <span id="bulk-count-${formId}" class="text-xs bg-blue-600 text-white px-2 py-1 rounded-full">
                                                0 sélectionné(s)
                                            </span>
                                        </div>
                                        <button onclick="hideBulkActions('${formId}')" class="text-gray-500 hover:text-gray-700">
                                            <i class="ri-close-line"></i>
                                        </button>
                                    </div>
                                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2">
                                        <button onclick="bulkEmail('${formId}')" 
                                                class="flex items-center justify-center space-x-2 bg-tremor-brand-DEFAULT hover:bg-tremor-brand-emphasis text-white py-2.5 px-3 rounded-tremor-default text-xs font-medium transition-all duration-200 shadow-tremor-input hover:shadow-tremor-card">
                                            <i class="ri-mail-line"></i><span>Email</span>
                                        </button>
                                        <button onclick="bulkSMS('${formId}')" 
                                                class="flex items-center justify-center space-x-2 bg-green-500 hover:bg-green-600 text-white py-2.5 px-3 rounded-tremor-default text-xs font-medium transition-all duration-200 shadow-tremor-input hover:shadow-tremor-card">
                                            <i class="ri-message-line"></i><span>SMS</span>
                                        </button>
                                        <button onclick="bulkNewsletter('${formId}')" 
                                                class="flex items-center justify-center space-x-2 bg-purple-500 hover:bg-purple-600 text-white py-2.5 px-3 rounded-tremor-default text-xs font-medium transition-all duration-200 shadow-tremor-input hover:shadow-tremor-card">
                                            <i class="ri-newsletter-line"></i><span>Newsletter</span>
                                        </button>
                                        <button onclick="bulkArchive('${formId}')" 
                                                class="flex items-center justify-center space-x-2 bg-orange-500 hover:bg-orange-600 text-white py-2.5 px-3 rounded-tremor-default text-xs font-medium transition-all duration-200 shadow-tremor-input hover:shadow-tremor-card">
                                            <i class="ri-archive-line"></i><span>Archiver</span>
                                        </button>
                                        <button onclick="bulkValidate('${formId}')" 
                                                class="flex items-center justify-center space-x-2 bg-emerald-500 hover:bg-emerald-600 text-white py-2.5 px-3 rounded-tremor-default text-xs font-medium transition-all duration-200 shadow-tremor-input hover:shadow-tremor-card">
                                            <i class="ri-check-line"></i><span>Valider</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Tableau des réponses -->
                            <div class="flex-1 overflow-y-auto">
                                <div id="responses-table-${formId}" class="p-6">
                                    ${generateAdaptiveTable(formId, formData, responses)}
                                </div>
                            </div>
                            
                            <!-- Pagination -->
                            <div class="bg-white border-t border-gray-200 px-6 py-4 flex items-center justify-between flex-shrink-0">
                                <div class="text-sm text-gray-600">
                                    Affichage de <span class="font-medium text-gray-900" id="page-start-${formId}">1</span> 
                                    à <span class="font-medium text-gray-900" id="page-end-${formId}">25</span> 
                                    sur <span class="font-medium text-gray-900" id="total-items-${formId}">${responseCount}</span> réponses
                                </div>
                                <div id="pagination-${formId}">
                                    ${generatePagination(formId, 1, Math.ceil(responseCount / 25))}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Initialiser les filtres et événements
            initializeAdaptiveFilters(formId);
            initializeTableEvents(formId);
            
            console.log('Modal de gestion des réponses initialisé avec succès');
        }
        
        // FORM MANAGEMENT FUNCTIONS
        function shareForm(formId, formName) {
            try {
                console.log('shareForm appelée avec:', formId, formName);
                const shareUrl = `${window.location.origin}/form/${formId}`;
                
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(shareUrl).then(() => {
                        showNotification(`Lien du formulaire "${formName}" copié dans le presse-papier!`, 'success');
                    }).catch(() => {
                        showShareModal(shareUrl, formName);
                    });
                } else {
                    showShareModal(shareUrl, formName);
                }
            } catch (error) {
                console.error('Erreur shareForm:', error);
                showNotification(`Erreur lors du partage: ${error.message}`, 'error');
            }
        }

        function showShareModal(url, formName) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">Partager - ${formName}</h3>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="ri-close-line text-xl"></i>
                        </button>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Lien du formulaire :</label>
                        <div class="flex">
                            <input type="text" value="${url}" readonly class="flex-1 p-2 border rounded-l-lg bg-gray-50" id="shareUrl">
                            <button onclick="copyToClipboard('shareUrl')" class="px-4 py-2 bg-blue-600 text-white rounded-r-lg hover:bg-blue-700">
                                Copier
                            </button>
                        </div>
                    </div>
                    <div class="flex justify-end">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">
                            Fermer
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function copyToClipboard(inputId) {
            const input = document.getElementById(inputId);
            input.select();
            document.execCommand('copy');
            showNotification('Lien copié!', 'success');
        }

        function showAnalytics(formId, formName) {
            showNotification(`Ouverture des analytics pour "${formName}"`, 'info');
            // Simuler l'ouverture des analytics - ici vous pourriez rediriger vers une page spécifique
            setTimeout(() => {
                const analyticsModal = document.createElement('div');
                analyticsModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                analyticsModal.innerHTML = `
                    <div class="bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold">Analytics - ${formName}</h3>
                            <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700">
                                <i class="ri-close-line text-xl"></i>
                            </button>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-blue-800">Vues totales</h4>
                                <p class="text-2xl font-bold text-blue-600">1,247</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-green-800">Réponses</h4>
                                <p class="text-2xl font-bold text-green-600">321</p>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-purple-800">Taux de conversion</h4>
                                <p class="text-2xl font-bold text-purple-600">26%</p>
                            </div>
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-orange-800">Temps moyen</h4>
                                <p class="text-2xl font-bold text-orange-600">3min 45s</p>
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(analyticsModal);
            }, 500);
        }

        function showQRCode(formId, formName) {
            const shareUrl = `${window.location.origin}/form/${formId}`;
            
            // Créer le modal QR Code
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold">QR Code - ${formName}</h3>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="ri-close-line text-xl"></i>
                        </button>
                    </div>
                    <div class="text-center">
                        <canvas id="qrcode-${formId}" class="mx-auto mb-4 border rounded-lg"></canvas>
                        <p class="text-sm text-gray-600 mb-4">Scannez ce QR code pour accéder au formulaire</p>
                        <div class="flex space-x-2">
                            <button onclick="downloadQR('${formId}', '${formName}')" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                                <i class="ri-download-line mr-2"></i>Télécharger
                            </button>
                            <button onclick="printQR('${formId}')" class="flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors">
                                <i class="ri-printer-line mr-2"></i>Imprimer
                            </button>
                        </div>
                        <div class="mt-3 pt-3 border-t">
                            <p class="text-xs text-gray-500 break-all">${shareUrl}</p>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Générer le QR code
            QRCode.toCanvas(document.getElementById(`qrcode-${formId}`), shareUrl, {
                width: 200,
                margin: 2,
                color: {
                    dark: '#000000',
                    light: '#FFFFFF'
                }
            });
        }

        function downloadQR(formId, formName) {
            const canvas = document.getElementById(`qrcode-${formId}`);
            const link = document.createElement('a');
            link.download = `qrcode-${formName.toLowerCase().replace(/\s+/g, '-')}.png`;
            link.href = canvas.toDataURL();
            link.click();
            showNotification('QR Code téléchargé!', 'success');
        }

        function printQR(formId) {
            const canvas = document.getElementById(`qrcode-${formId}`);
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>QR Code</title>
                        <style>
                            body { text-align: center; padding: 20px; font-family: Arial, sans-serif; }
                            .qr-container { margin: 20px auto; }
                            .url { font-size: 12px; color: #666; margin-top: 10px; word-break: break-all; }
                        </style>
                    </head>
                    <body>
                        <div class="qr-container">
                            <h2>QR Code - Formulaire</h2>
                            <img src="${canvas.toDataURL()}" style="border: 1px solid #ddd; border-radius: 8px;" />
                            <div class="url">Scannez pour accéder au formulaire</div>
                        </div>
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function restoreForm(formId, formName) {
            if (confirm(`Êtes-vous sûr de vouloir restaurer le formulaire "${formName}" ?`)) {
                showNotification(`Formulaire "${formName}" restauré avec succès!`, 'success');
                // Ici vous pourriez faire l'appel API pour restaurer le formulaire
                // location.reload(); // Pour rafraîchir la page après restauration
            }
        }

        function exportFormData(formId, formName) {
            showNotification(`Export des données pour "${formName}" en cours...`, 'info');
            // Simuler l'export
            setTimeout(() => {
                // Créer un fichier CSV simulé
                const csvContent = "data:text/csv;charset=utf-8,Date,Nom,Email,Message\\n2025-01-15,Jean Dupont,jean@email.com,Excellent service\\n2025-01-14,Marie Martin,marie@email.com,Très satisfaite";
                const link = document.createElement('a');
                link.href = csvContent;
                link.download = `export-${formName.toLowerCase().replace(/\s+/g, '-')}.csv`;
                link.click();
                showNotification(`Données exportées pour "${formName}"!`, 'success');
            }, 1500);
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg text-white z-50 transition-all duration-300 ${
                type === 'success' ? 'bg-green-600' : 
                type === 'error' ? 'bg-red-600' : 'bg-blue-600'
            }`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="ri-${type === 'success' ? 'check' : type === 'error' ? 'error-warning' : 'information'}-line mr-2"></i>
                    ${message}
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // VISUALISATION DU FORMULAIRE
        function viewForm(formId, formName) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="sticky top-0 bg-white border-b p-4 flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-semibold">${formName}</h3>
                            <p class="text-sm text-gray-600">Aperçu du formulaire</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="fillForm('${formId}', '${formName}')" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                <i class="ri-edit-line mr-1"></i>Remplir
                            </button>
                            <button onclick="this.parentElement.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700">
                                <i class="ri-close-line text-xl"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-6">
                        ${getFormPreview(formId)}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function getFormPreview(formId) {
            // Simuler différents types de formulaires
            const forms = {
                'form-1': `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Nom complet *</label>
                            <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Votre nom et prénom" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email *</label>
                            <input type="email" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="votre@email.com" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Téléphone</label>
                            <input type="tel" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="+33 1 23 45 67 89" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Sujet *</label>
                            <select class="w-full p-3 border rounded-lg bg-gray-50" disabled>
                                <option>Sélectionnez un sujet</option>
                                <option>Information produit</option>
                                <option>Support technique</option>
                                <option>Partenariat</option>
                                <option>Autre</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Message *</label>
                            <textarea class="w-full p-3 border rounded-lg bg-gray-50 h-32" placeholder="Votre message..." readonly></textarea>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" class="mr-2" disabled>
                            <label class="text-sm">J'accepte de recevoir des communications marketing</label>
                        </div>
                    </div>
                `,
                'form-2': `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Nom *</label>
                            <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Votre nom" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-3">Évaluez votre satisfaction globale *</label>
                            <div class="flex space-x-2">
                                ${[1,2,3,4,5].map(i => `
                                    <label class="flex flex-col items-center cursor-pointer">
                                        <input type="radio" name="satisfaction" class="mb-1" disabled>
                                        <span class="text-sm">${i === 1 ? 'Très insatisfait' : i === 5 ? 'Très satisfait' : i}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Recommanderiez-vous nos services ? *</label>
                            <div class="space-y-2">
                                <label class="flex items-center"><input type="radio" name="recommend" class="mr-2" disabled> Oui, certainement</label>
                                <label class="flex items-center"><input type="radio" name="recommend" class="mr-2" disabled> Probablement</label>
                                <label class="flex items-center"><input type="radio" name="recommend" class="mr-2" disabled> Peut-être</label>
                                <label class="flex items-center"><input type="radio" name="recommend" class="mr-2" disabled> Probablement pas</label>
                                <label class="flex items-center"><input type="radio" name="recommend" class="mr-2" disabled> Non</label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Commentaires additionnels</label>
                            <textarea class="w-full p-3 border rounded-lg bg-gray-50 h-24" placeholder="Vos suggestions..." readonly></textarea>
                        </div>
                    </div>
                `,
                'form-3': `
                    <div class="space-y-4">
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h4 class="font-semibold text-blue-800">Webinar: Les tendances du marketing digital 2025</h4>
                            <p class="text-blue-600 text-sm">25 janvier 2025 • 14h00-16h00 • En ligne</p>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Prénom *</label>
                                <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Votre prénom" readonly>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Nom *</label>
                                <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Votre nom" readonly>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email professionnel *</label>
                            <input type="email" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="votre@entreprise.com" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Entreprise *</label>
                            <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Nom de votre entreprise" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Poste/Fonction *</label>
                            <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Votre fonction" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Secteur d'activité</label>
                            <select class="w-full p-3 border rounded-lg bg-gray-50" disabled>
                                <option>Sélectionnez votre secteur</option>
                                <option>Technologie</option>
                                <option>Marketing/Communication</option>
                                <option>E-commerce</option>
                                <option>Conseil</option>
                                <option>Autre</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Quels sujets vous intéressent le plus ?</label>
                            <div class="space-y-2">
                                <label class="flex items-center"><input type="checkbox" class="mr-2" disabled> Intelligence Artificielle</label>
                                <label class="flex items-center"><input type="checkbox" class="mr-2" disabled> Marketing automation</label>
                                <label class="flex items-center"><input type="checkbox" class="mr-2" disabled> Personnalisation</label>
                                <label class="flex items-center"><input type="checkbox" class="mr-2" disabled> Analytics avancés</label>
                            </div>
                        </div>
                    </div>
                `,
                'form-4': `
                    <div class="space-y-4">
                        <div class="bg-orange-50 p-4 rounded-lg mb-4">
                            <p class="text-orange-800 text-sm"><i class="ri-archive-line mr-1"></i>Ce formulaire est archivé</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Nom du produit évalué *</label>
                            <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Nom du produit" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Note globale *</label>
                            <div class="flex space-x-1">
                                ${[1,2,3,4,5].map(i => `<span class="text-2xl text-gray-300">⭐</span>`).join('')}
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Qu'avez-vous le plus apprécié ?</label>
                            <textarea class="w-full p-3 border rounded-lg bg-gray-50 h-20" readonly></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Suggestions d'amélioration</label>
                            <textarea class="w-full p-3 border rounded-lg bg-gray-50 h-20" readonly></textarea>
                        </div>
                    </div>
                `
            };
            return forms[formId] || '<p class="text-center text-gray-500">Formulaire non trouvé</p>';
        }

        // REMPLISSAGE DE FORMULAIRE
        function fillForm(formId, formName) {
            // Fermer le modal de visualisation
            document.querySelector('.fixed.inset-0').remove();
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                    <div class="sticky top-0 bg-white border-b p-4 flex justify-between items-center">
                        <div>
                            <h3 class="text-lg font-semibold">${formName}</h3>
                            <p class="text-sm text-gray-600">Saisie de données</p>
                        </div>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-500 hover:text-gray-700">
                            <i class="ri-close-line text-xl"></i>
                        </button>
                    </div>
                    <form onsubmit="submitForm(event, '${formId}', '${formName}')" class="p-6">
                        ${getEditableForm(formId)}
                        <div class="flex justify-end space-x-2 mt-6 pt-4 border-t">
                            <button type="button" onclick="this.parentElement.parentElement.parentElement.parentElement.remove()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">
                                Annuler
                            </button>
                            <button type="submit" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                <i class="ri-send-plane-line mr-1"></i>Soumettre
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function getEditableForm(formId) {
            // Formulaires éditables (copies des aperçus mais avec inputs fonctionnels)
            const forms = {
                'form-1': `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Nom complet *</label>
                            <input type="text" name="fullName" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Votre nom et prénom">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email *</label>
                            <input type="email" name="email" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="votre@email.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Téléphone</label>
                            <input type="tel" name="phone" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="+33 1 23 45 67 89">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Sujet *</label>
                            <select name="subject" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Sélectionnez un sujet</option>
                                <option value="product">Information produit</option>
                                <option value="support">Support technique</option>
                                <option value="partnership">Partenariat</option>
                                <option value="other">Autre</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Message *</label>
                            <textarea name="message" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 h-32" placeholder="Votre message..."></textarea>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" name="marketing" class="mr-2">
                            <label class="text-sm">J'accepte de recevoir des communications marketing</label>
                        </div>
                    </div>
                `,
                'form-2': `
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Nom *</label>
                            <input type="text" name="name" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Votre nom">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-3">Évaluez votre satisfaction globale *</label>
                            <div class="flex space-x-4">
                                ${[1,2,3,4,5].map(i => `
                                    <label class="flex flex-col items-center cursor-pointer">
                                        <input type="radio" name="satisfaction" value="${i}" required class="mb-1">
                                        <span class="text-sm text-center">${i === 1 ? 'Très insatisfait' : i === 5 ? 'Très satisfait' : i}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Recommanderiez-vous nos services ? *</label>
                            <div class="space-y-2">
                                <label class="flex items-center"><input type="radio" name="recommend" value="yes" required class="mr-2"> Oui, certainement</label>
                                <label class="flex items-center"><input type="radio" name="recommend" value="probably" required class="mr-2"> Probablement</label>
                                <label class="flex items-center"><input type="radio" name="recommend" value="maybe" required class="mr-2"> Peut-être</label>
                                <label class="flex items-center"><input type="radio" name="recommend" value="probably-not" required class="mr-2"> Probablement pas</label>
                                <label class="flex items-center"><input type="radio" name="recommend" value="no" required class="mr-2"> Non</label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Commentaires additionnels</label>
                            <textarea name="comments" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 h-24" placeholder="Vos suggestions..."></textarea>
                        </div>
                    </div>
                `,
                'form-3': `
                    <div class="space-y-4">
                        <div class="bg-blue-50 p-4 rounded-lg mb-4">
                            <h4 class="font-semibold text-blue-800">Webinar: Les tendances du marketing digital 2025</h4>
                            <p class="text-blue-600 text-sm">25 janvier 2025 • 14h00-16h00 • En ligne</p>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Prénom *</label>
                                <input type="text" name="firstName" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Votre prénom">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Nom *</label>
                                <input type="text" name="lastName" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Votre nom">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email professionnel *</label>
                            <input type="email" name="email" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="votre@entreprise.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Entreprise *</label>
                            <input type="text" name="company" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Nom de votre entreprise">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Poste/Fonction *</label>
                            <input type="text" name="position" required class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Votre fonction">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Secteur d'activité</label>
                            <select name="industry" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Sélectionnez votre secteur</option>
                                <option value="tech">Technologie</option>
                                <option value="marketing">Marketing/Communication</option>
                                <option value="ecommerce">E-commerce</option>
                                <option value="consulting">Conseil</option>
                                <option value="other">Autre</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Quels sujets vous intéressent le plus ?</label>
                            <div class="space-y-2">
                                <label class="flex items-center"><input type="checkbox" name="interests" value="ai" class="mr-2"> Intelligence Artificielle</label>
                                <label class="flex items-center"><input type="checkbox" name="interests" value="automation" class="mr-2"> Marketing automation</label>
                                <label class="flex items-center"><input type="checkbox" name="interests" value="personalization" class="mr-2"> Personnalisation</label>
                                <label class="flex items-center"><input type="checkbox" name="interests" value="analytics" class="mr-2"> Analytics avancés</label>
                            </div>
                        </div>
                    </div>
                `,
                'form-4': `
                    <div class="space-y-4">
                        <div class="bg-orange-50 p-4 rounded-lg mb-4">
                            <p class="text-orange-800 text-sm"><i class="ri-archive-line mr-1"></i>Ce formulaire est archivé</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Nom du produit évalué *</label>
                            <input type="text" class="w-full p-3 border rounded-lg bg-gray-50" placeholder="Nom du produit" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Note globale *</label>
                            <div class="flex space-x-1">
                                ${[1,2,3,4,5].map(i => `<span class="text-2xl text-gray-300">⭐</span>`).join('')}
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Qu'avez-vous le plus apprécié ?</label>
                            <textarea class="w-full p-3 border rounded-lg bg-gray-50 h-20" readonly></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Suggestions d'amélioration</label>
                            <textarea class="w-full p-3 border rounded-lg bg-gray-50 h-20" readonly></textarea>
                        </div>
                    </div>
                `
            };
            return forms[formId] || '<p class="text-center text-gray-500">Formulaire non trouvé</p>';
        }
        
        // Fonctions auxiliaires pour le modal des réponses
        function getSmartFiltersHTML(formId) {
            const filters = {
                'form-1': `
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px;">📅 Période</label>
                        <input type="date" style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; margin-bottom: 8px; font-size: 14px;">
                        <input type="date" style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;">
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px;">🏷️ Sujet</label>
                        <label style="display: flex; align-items: center; margin-bottom: 6px; padding: 4px; border-radius: 4px; cursor: pointer; font-size: 14px;" onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='transparent'">
                            <input type="checkbox" style="margin-right: 8px;"> Support technique
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 6px; padding: 4px; border-radius: 4px; cursor: pointer; font-size: 14px;" onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='transparent'">
                            <input type="checkbox" style="margin-right: 8px;"> Information produit
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 6px; padding: 4px; border-radius: 4px; cursor: pointer; font-size: 14px;" onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='transparent'">
                            <input type="checkbox" style="margin-right: 8px;"> Partenariat
                        </label>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px;">🔍 Recherche</label>
                        <input type="text" placeholder="Nom, email, message..." style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;">
                    </div>
                `,
                'form-2': `
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px;">⭐ Satisfaction</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> ⭐ Très insatisfait</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> ⭐⭐ Insatisfait</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> ⭐⭐⭐ Neutre</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> ⭐⭐⭐⭐ Satisfait</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> ⭐⭐⭐⭐⭐ Très satisfait</label>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px;">🔍 Recherche</label>
                        <input type="text" placeholder="Nom ou commentaire..." style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;">
                    </div>
                `,
                'form-3': `
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px;">🏢 Secteur</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> Technologie</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> Marketing</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> E-commerce</label>
                        <label style="display: flex; align-items: center; margin-bottom: 4px; cursor: pointer; font-size: 14px;"><input type="checkbox" style="margin-right: 8px;"> Conseil</label>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 500; font-size: 14px;">🔍 Recherche</label>
                        <input type="text" placeholder="Nom, entreprise, poste..." style="width: 100%; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; font-size: 14px;">
                    </div>
                `
            };
            return filters[formId] || '<p style="color: #6b7280; font-size: 14px;">Aucun filtre disponible</p>';
        }

        // FONCTIONS DE SUPPORT POUR FILTRES ADAPTATIFS
        function getFormDataStructure(formId) {
            const structures = {
                'form-1': { // Formulaire de Contact
                    type: 'contact',
                    fields: [
                        { name: 'nom', type: 'text', label: 'Nom' },
                        { name: 'email', type: 'email', label: 'Email' },
                        { name: 'telephone', type: 'tel', label: 'Téléphone' },
                        { name: 'sujet', type: 'select', label: 'Sujet', options: ['Support technique', 'Question commerciale', 'Demande de devis', 'Réclamation', 'Autre'] },
                        { name: 'message', type: 'textarea', label: 'Message' },
                        { name: 'priorite', type: 'select', label: 'Priorité', options: ['Faible', 'Normale', 'Élevée', 'Urgente'] },
                        { name: 'statut', type: 'select', label: 'Statut', options: ['Nouveau', 'En cours', 'Résolu', 'Fermé'] }
                    ]
                },
                'form-2': { // Sondage Satisfaction
                    type: 'survey',
                    fields: [
                        { name: 'nom', type: 'text', label: 'Nom' },
                        { name: 'email', type: 'email', label: 'Email' },
                        { name: 'satisfaction_generale', type: 'rating', label: 'Satisfaction générale', max: 5 },
                        { name: 'qualite_service', type: 'rating', label: 'Qualité du service', max: 5 },
                        { name: 'temps_reponse', type: 'rating', label: 'Temps de réponse', max: 5 },
                        { name: 'recommandation', type: 'select', label: 'Recommandation', options: ['Très probable', 'Probable', 'Neutre', 'Peu probable', 'Très peu probable'] },
                        { name: 'commentaires', type: 'textarea', label: 'Commentaires' },
                        { name: 'segment_client', type: 'select', label: 'Segment', options: ['Particulier', 'PME', 'Grande entreprise', 'Association'] }
                    ]
                },
                'form-3': { // Inscription Événement
                    type: 'event',
                    fields: [
                        { name: 'nom', type: 'text', label: 'Nom' },
                        { name: 'prenom', type: 'text', label: 'Prénom' },
                        { name: 'email', type: 'email', label: 'Email' },
                        { name: 'telephone', type: 'tel', label: 'Téléphone' },
                        { name: 'entreprise', type: 'text', label: 'Entreprise' },
                        { name: 'poste', type: 'text', label: 'Poste' },
                        { name: 'type_billet', type: 'select', label: 'Type de billet', options: ['Standard', 'VIP', 'Étudiant', 'Groupe'] },
                        { name: 'regime_alimentaire', type: 'select', label: 'Régime alimentaire', options: ['Aucun', 'Végétarien', 'Végétalien', 'Sans gluten', 'Halal', 'Casher'] },
                        { name: 'statut_inscription', type: 'select', label: 'Statut', options: ['Confirmé', 'En attente', 'Annulé', 'Présent'] }
                    ]
                }
            };
            return structures[formId] || structures['form-1'];
        }

        function getAdaptiveFilters(formId, formData) {
            let filtersHtml = '';
            
            // Filtre par date (toujours présent)
            filtersHtml += `
                <div class="space-y-3">
                    <h4 class="text-sm font-semibold text-gray-900 flex items-center">
                        <i class="ri-calendar-line mr-2 text-blue-600"></i>
                        Période
                    </h4>
                    <div class="space-y-2">
                        <input type="date" id="date-start-${formId}" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                        <input type="date" id="date-end-${formId}" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                </div>
            `;
            
            // Filtres spécifiques selon le type de formulaire
            formData.fields.forEach(field => {
                if (field.type === 'select') {
                    filtersHtml += `
                        <div class="space-y-3">
                            <h4 class="text-sm font-semibold text-gray-900 flex items-center">
                                <i class="ri-filter-line mr-2 text-blue-600"></i>
                                ${field.label}
                            </h4>
                            <select id="filter-${field.name}-${formId}" class="w-full p-2 border border-gray-300 rounded-lg text-sm" onchange="applyFilters('${formId}')">
                                <option value="">Tous</option>
                                ${field.options.map(option => `<option value="${option}">${option}</option>`).join('')}
                            </select>
                        </div>
                    `;
                } else if (field.type === 'rating') {
                    filtersHtml += `
                        <div class="space-y-3">
                            <h4 class="text-sm font-semibold text-gray-900 flex items-center">
                                <i class="ri-star-line mr-2 text-blue-600"></i>
                                ${field.label}
                            </h4>
                            <div class="space-y-2">
                                <input type="range" id="filter-${field.name}-${formId}" min="1" max="${field.max}" class="w-full" onchange="applyFilters('${formId}')">
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>1 étoile</span>
                                    <span>${field.max} étoiles</span>
                                </div>
                            </div>
                        </div>
                    `;
                }
            });
            
            // Filtres supplémentaires selon le type
            if (formData.type === 'contact') {
                filtersHtml += `
                    <div class="space-y-3">
                        <h4 class="text-sm font-semibold text-gray-900 flex items-center">
                            <i class="ri-search-line mr-2 text-blue-600"></i>
                            Recherche textuelle
                        </h4>
                        <input type="text" id="search-text-${formId}" placeholder="Rechercher dans les messages..." 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm" onkeyup="applyFilters('${formId}')">
                    </div>
                `;
            } else if (formData.type === 'survey') {
                filtersHtml += `
                    <div class="space-y-3">
                        <h4 class="text-sm font-semibold text-gray-900 flex items-center">
                            <i class="ri-emotion-line mr-2 text-blue-600"></i>
                            Satisfaction globale
                        </h4>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="filterBySatisfaction('${formId}', 'high')" class="p-2 bg-green-100 hover:bg-green-200 text-green-700 rounded-lg text-xs">
                                Élevée (4-5★)
                            </button>
                            <button onclick="filterBySatisfaction('${formId}', 'low')" class="p-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg text-xs">
                                Faible (1-2★)
                            </button>
                        </div>
                    </div>
                `;
            } else if (formData.type === 'event') {
                filtersHtml += `
                    <div class="space-y-3">
                        <h4 class="text-sm font-semibold text-gray-900 flex items-center">
                            <i class="ri-building-line mr-2 text-blue-600"></i>
                            Recherche entreprise
                        </h4>
                        <input type="text" id="search-company-${formId}" placeholder="Nom d'entreprise..." 
                               class="w-full p-2 border border-gray-300 rounded-lg text-sm" onkeyup="applyFilters('${formId}')">
                    </div>
                `;
            }
            
            return filtersHtml;
        }

        function generateAdaptiveResponses(formId, count) {
            const formData = getFormDataStructure(formId);
            const responses = [];
            
            for (let i = 1; i <= Math.min(count, 25); i++) {
                const response = {
                    id: i,
                    date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    selected: false
                };
                
                formData.fields.forEach(field => {
                    if (field.type === 'text') {
                        response[field.name] = generateRandomText(field.name);
                    } else if (field.type === 'email') {
                        response[field.name] = generateRandomEmail();
                    } else if (field.type === 'tel') {
                        response[field.name] = generateRandomPhone();
                    } else if (field.type === 'select') {
                        response[field.name] = field.options[Math.floor(Math.random() * field.options.length)];
                    } else if (field.type === 'rating') {
                        response[field.name] = Math.floor(Math.random() * field.max) + 1;
                    } else if (field.type === 'textarea') {
                        response[field.name] = generateRandomMessage();
                    }
                });
                
                responses.push(response);
            }
            
            return responses;
        }

        function generateAdaptiveTable(formId, formData, responses) {
            const tableHeaders = formData.fields.slice(0, 6).map(field => 
                `<th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">${field.label}</th>`
            ).join('');
            
            const tableRows = responses.map(response => {
                const cells = formData.fields.slice(0, 6).map(field => {
                    let cellContent = response[field.name] || '-';
                    
                    if (field.type === 'rating') {
                        cellContent = `
                            <div class="flex items-center space-x-1">
                                ${Array.from({length: field.max}, (_, i) => 
                                    `<i class="ri-star${i < cellContent ? '-fill' : '-line'} text-yellow-400 text-sm"></i>`
                                ).join('')}
                                <span class="text-xs text-gray-500 ml-1">(${cellContent})</span>
                            </div>
                        `;
                    } else if (field.type === 'select' && field.name === 'statut') {
                        const statusColors = {
                            'Nouveau': 'bg-blue-100 text-blue-800',
                            'En cours': 'bg-yellow-100 text-yellow-800',
                            'Résolu': 'bg-green-100 text-green-800',
                            'Fermé': 'bg-gray-100 text-gray-800',
                            'Confirmé': 'bg-green-100 text-green-800',
                            'En attente': 'bg-yellow-100 text-yellow-800',
                            'Annulé': 'bg-red-100 text-red-800',
                            'Présent': 'bg-blue-100 text-blue-800'
                        };
                        const colorClass = statusColors[cellContent] || 'bg-gray-100 text-gray-800';
                        cellContent = `<span class="px-2 py-1 text-xs font-medium rounded-full ${colorClass}">${cellContent}</span>`;
                    } else if (field.type === 'textarea') {
                        cellContent = cellContent.length > 50 ? cellContent.substring(0, 50) + '...' : cellContent;
                    }
                    
                    return `<td class="px-4 py-4 whitespace-nowrap text-sm text-gray-900">${cellContent}</td>`;
                }).join('');
                
                return `
                    <tr class="hover:bg-gray-50 transition-colors duration-150 ease-in-out">
                        <td class="px-4 py-4 whitespace-nowrap">
                            <input type="checkbox" class="response-checkbox w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2" 
                                   data-id="${response.id}" onchange="updateSelectionCount('${formId}')">
                        </td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">#${response.id}</td>
                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">${response.date}</td>
                        ${cells}
                        <td class="px-4 py-4 whitespace-nowrap text-right text-sm font-medium">
                            <div class="flex items-center space-x-2">
                                <button onclick="viewResponseDetail('${response.id}')" class="text-blue-600 hover:text-blue-900 p-1 rounded">
                                    <i class="ri-eye-line"></i>
                                </button>
                                <button onclick="editResponseDetail('${response.id}')" class="text-green-600 hover:text-green-900 p-1 rounded">
                                    <i class="ri-edit-line"></i>
                                </button>
                                <button onclick="deleteResponse('${response.id}')" class="text-red-600 hover:text-red-900 p-1 rounded">
                                    <i class="ri-delete-bin-line"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
            
            return `
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <input type="checkbox" id="table-select-all" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2">
                                </th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                ${tableHeaders}
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            ${tableRows}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function generatePagination(formId, currentPage, totalPages) {
            let paginationHtml = '<div class="flex items-center space-x-2">';
            
            // Bouton précédent
            paginationHtml += `
                <button onclick="changePage('${formId}', ${currentPage - 1})" 
                        ${currentPage <= 1 ? 'disabled' : ''}
                        class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="ri-arrow-left-line"></i>
                </button>
            `;
            
            // Numéros de page
            for (let i = Math.max(1, currentPage - 2); i <= Math.min(totalPages, currentPage + 2); i++) {
                const isActive = i === currentPage;
                paginationHtml += `
                    <button onclick="changePage('${formId}', ${i})" 
                            class="px-3 py-2 text-sm font-medium ${isActive ? 'text-white bg-blue-600' : 'text-gray-700 bg-white border border-gray-300 hover:bg-gray-50'} rounded-lg">
                        ${i}
                    </button>
                `;
            }
            
            // Bouton suivant
            paginationHtml += `
                <button onclick="changePage('${formId}', ${currentPage + 1})" 
                        ${currentPage >= totalPages ? 'disabled' : ''}
                        class="px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">
                    <i class="ri-arrow-right-line"></i>
                </button>
            `;
            
            paginationHtml += '</div>';
            return paginationHtml;
        }

        // FONCTIONS UTILITAIRES DE GÉNÉRATION DE DONNÉES
        function generateRandomText(fieldName) {
            const names = ['Dupont', 'Martin', 'Bernard', 'Durand', 'Leroy', 'Moreau', 'Simon', 'Laurent'];
            const firstNames = ['Jean', 'Marie', 'Pierre', 'Paul', 'Jacques', 'Michel', 'Robert', 'André'];
            const companies = ['TechCorp', 'InnoSoft', 'DataFlow', 'CloudTech', 'WebSolutions', 'DigitalPro'];
            
            if (fieldName === 'nom') return names[Math.floor(Math.random() * names.length)];
            if (fieldName === 'prenom') return firstNames[Math.floor(Math.random() * firstNames.length)];
            if (fieldName === 'entreprise') return companies[Math.floor(Math.random() * companies.length)];
            if (fieldName === 'poste') return ['Développeur', 'Chef de projet', 'Directeur', 'Consultant'][Math.floor(Math.random() * 4)];
            
            return 'Texte généré';
        }

        function generateRandomEmail() {
            const domains = ['gmail.com', 'hotmail.fr', 'yahoo.fr', 'orange.fr'];
            const names = ['jean.dupont', 'marie.martin', 'pierre.durand', 'paul.simon'];
            return names[Math.floor(Math.random() * names.length)] + '@' + domains[Math.floor(Math.random() * domains.length)];
        }

        function generateRandomPhone() {
            return '0' + Math.floor(Math.random() * 9 + 1) + ' ' + 
                   Math.floor(Math.random() * 90 + 10) + ' ' +
                   Math.floor(Math.random() * 90 + 10) + ' ' +
                   Math.floor(Math.random() * 90 + 10) + ' ' +
                   Math.floor(Math.random() * 90 + 10);
        }

        function generateRandomMessage() {
            const messages = [
                'Bonjour, j\'ai un problème avec votre service...',
                'Pourriez-vous me donner plus d\'informations sur vos tarifs ?',
                'Je souhaiterais obtenir un devis pour mon projet.',
                'Votre équipe a été très professionnelle, merci !',
                'Il y a eu un dysfonctionnement ce matin...'
            ];
            return messages[Math.floor(Math.random() * messages.length)];
        }

        // FONCTIONS D'INTERACTION ET DE GESTION
        function initializeAdaptiveFilters(formId) {
            // Initialiser les écouteurs d'événements pour les filtres
            const dateStartInput = document.getElementById(`date-start-${formId}`);
            const dateEndInput = document.getElementById(`date-end-${formId}`);
            
            if (dateStartInput) {
                dateStartInput.addEventListener('change', () => applyFilters(formId));
            }
            if (dateEndInput) {
                dateEndInput.addEventListener('change', () => applyFilters(formId));
            }
            
            console.log('Filtres adaptatifs initialisés pour', formId);
        }

        function initializeTableEvents(formId) {
            // Gestionnaire pour la sélection globale
            const selectAllCheckbox = document.getElementById(`select-all-${formId}`);
            if (selectAllCheckbox) {
                selectAllCheckbox.addEventListener('change', function() {
                    toggleSelectAll(formId);
                });
            }
            
            // Gestionnaire pour les checkboxes individuelles
            document.querySelectorAll('.response-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', () => updateSelectionCount(formId));
            });
            
            console.log('Événements de table initialisés pour', formId);
        }

        function applyFilters(formId) {
            console.log('Application des filtres pour', formId);
            // Logique de filtrage ici
            showNotification('Filtres appliqués', 'success');
        }

        function resetFilters(formId) {
            // Réinitialiser tous les filtres
            const modal = document.querySelector('.fixed');
            if (modal) {
                modal.querySelectorAll('input, select').forEach(input => {
                    if (input.type === 'checkbox') {
                        input.checked = false;
                    } else {
                        input.value = '';
                    }
                });
            }
            applyFilters(formId);
            showNotification('Filtres réinitialisés', 'info');
        }

        function filterBySatisfaction(formId, level) {
            console.log(`Filtrage par satisfaction ${level} pour ${formId}`);
            showNotification(`Affichage des réponses avec satisfaction ${level === 'high' ? 'élevée' : 'faible'}`, 'info');
        }

        function updateSelectionCount(formId) {
            const checkboxes = document.querySelectorAll('.response-checkbox:checked');
            const count = checkboxes.length;
            
            // Mettre à jour les compteurs
            const selectionCount = document.getElementById(`selection-count-${formId}`);
            const bulkCount = document.getElementById(`bulk-count-${formId}`);
            const bulkActions = document.getElementById(`bulk-actions-${formId}`);
            
            if (selectionCount) {
                selectionCount.textContent = `${count} sélectionné(s)`;
            }
            
            if (bulkCount) {
                bulkCount.textContent = `${count} sélectionné(s)`;
            }
            
            // Afficher/masquer les actions en lot
            if (bulkActions) {
                if (count > 0) {
                    bulkActions.classList.remove('hidden');
                } else {
                    bulkActions.classList.add('hidden');
                }
            }
        }

        function hideBulkActions(formId) {
            const bulkActions = document.getElementById(`bulk-actions-${formId}`);
            if (bulkActions) {
                bulkActions.classList.add('hidden');
            }
            
            // Désélectionner tous les éléments
            document.querySelectorAll('.response-checkbox').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            updateSelectionCount(formId);
        }

        function changePage(formId, page) {
            console.log(`Changement de page ${page} pour ${formId}`);
            showNotification(`Page ${page} chargée`, 'info');
        }

        function changePerPage(formId) {
            const select = document.getElementById(`per-page-${formId}`);
            const value = select.value;
            console.log(`Changement du nombre d'éléments par page: ${value} pour ${formId}`);
            showNotification(`Affichage de ${value} éléments par page`, 'info');
        }

        function exportResponses(formId, formName) {
            showNotification(`Export des réponses de "${formName}" en cours...`, 'info');
            
            // Simulation d'export
            setTimeout(() => {
                showNotification(`Export de "${formName}" terminé avec succès!`, 'success');
            }, 1500);
        }

        function viewResponseDetail(responseId) {
            showNotification(`Affichage détaillé de la réponse #${responseId}`, 'info');
        }

        function editResponseDetail(responseId) {
            showNotification(`Modification de la réponse #${responseId}`, 'info');
        }

        function deleteResponse(responseId) {
            if (confirm(`Êtes-vous sûr de vouloir supprimer la réponse #${responseId} ?`)) {
                showNotification(`Réponse #${responseId} supprimée`, 'success');
            }
        }

        // FONCTIONS D'ACTIONS EN LOT AVANCÉES
        function bulkEmail(formId) {
            const selectedResponses = getSelectedResponses();
            if (selectedResponses.length === 0) {
                showNotification('Aucune réponse sélectionnée', 'warning');
                return;
            }

            // Créer le modal d'envoi d'email
            const emailModal = document.createElement('div');
            emailModal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4';
            emailModal.innerHTML = `
                <div class="bg-white rounded-tremor-default shadow-tremor-dropdown max-w-2xl w-full max-h-[80vh] overflow-y-auto">
                    <div class="bg-tremor-brand-DEFAULT text-white p-6 rounded-t-tremor-default">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-semibold flex items-center">
                                <i class="ri-mail-line mr-2"></i>
                                Envoi d'email groupé
                            </h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-white/80 hover:text-white">
                                <i class="ri-close-line text-xl"></i>
                            </button>
                        </div>
                        <p class="text-white/80 mt-2">${selectedResponses.length} destinataire(s) sélectionné(s)</p>
                    </div>
                    
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-tremor-content-strong mb-2">Objet de l'email</label>
                            <input type="text" id="email-subject" placeholder="Entrez l'objet de votre email..." 
                                   class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-tremor-brand-emphasis focus:border-tremor-brand-emphasis">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-tremor-content-strong mb-2">Message</label>
                            <textarea id="email-message" rows="6" placeholder="Rédigez votre message..."
                                      class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-tremor-brand-emphasis focus:border-tremor-brand-emphasis resize-none"></textarea>
                        </div>
                        
                        <div class="bg-tremor-background-muted p-4 rounded-tremor-default">
                            <h4 class="text-sm font-medium text-tremor-content-strong mb-2">Variables disponibles :</h4>
                            <div class="grid grid-cols-2 gap-2 text-xs text-tremor-content-subtle">
                                <span class="bg-white px-2 py-1 rounded">{{nom}}</span>
                                <span class="bg-white px-2 py-1 rounded">{{email}}</span>
                                <span class="bg-white px-2 py-1 rounded">{{entreprise}}</span>
                                <span class="bg-white px-2 py-1 rounded">{{date}}</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-3">
                            <input type="checkbox" id="email-template" class="w-4 h-4 text-tremor-brand-emphasis">
                            <label for="email-template" class="text-sm text-tremor-content-emphasis">Sauvegarder comme modèle</label>
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button onclick="sendBulkEmail('${formId}')" 
                                    class="flex-1 bg-tremor-brand-DEFAULT hover:bg-tremor-brand-emphasis text-white py-3 px-4 rounded-tremor-default font-medium transition-colors duration-200">
                                <i class="ri-send-plane-line mr-2"></i>Envoyer
                            </button>
                            <button onclick="this.closest('.fixed').remove()" 
                                    class="px-6 py-3 border border-tremor-border text-tremor-content-emphasis rounded-tremor-default hover:bg-tremor-background-muted transition-colors duration-200">
                                Annuler
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(emailModal);
        }

        function bulkSMS(formId) {
            const selectedResponses = getSelectedResponses();
            if (selectedResponses.length === 0) {
                showNotification('Aucune réponse sélectionnée', 'warning');
                return;
            }

            // Vérifier que les contacts ont des numéros de téléphone
            const contactsWithPhone = selectedResponses.filter(r => r.dataset.phone);
            if (contactsWithPhone.length === 0) {
                showNotification('Aucun numéro de téléphone trouvé dans les contacts sélectionnés', 'error');
                return;
            }

            const smsModal = document.createElement('div');
            smsModal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4';
            smsModal.innerHTML = `
                <div class="bg-white rounded-tremor-default shadow-tremor-dropdown max-w-lg w-full">
                    <div class="bg-green-500 text-white p-6 rounded-t-tremor-default">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-semibold flex items-center">
                                <i class="ri-message-line mr-2"></i>
                                Envoi de SMS groupé
                            </h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-white/80 hover:text-white">
                                <i class="ri-close-line text-xl"></i>
                            </button>
                        </div>
                        <p class="text-white/80 mt-2">${contactsWithPhone.length} destinataire(s) avec téléphone</p>
                    </div>
                    
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-tremor-content-strong mb-2">Message SMS</label>
                            <textarea id="sms-message" rows="4" maxlength="160" placeholder="Rédigez votre SMS (max 160 caractères)..."
                                      class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none"
                                      oninput="updateSMSCounter()"></textarea>
                            <div class="flex justify-between items-center mt-2">
                                <span class="text-xs text-tremor-content-subtle">Variables: {{nom}}, {{prenom}}</span>
                                <span id="sms-counter" class="text-xs text-tremor-content-subtle">0/160</span>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 border border-yellow-200 p-3 rounded-tremor-default">
                            <div class="flex items-start space-x-2">
                                <i class="ri-information-line text-yellow-600 mt-0.5"></i>
                                <div class="text-sm text-yellow-800">
                                    <p class="font-medium">Coût estimé</p>
                                    <p>€${(contactsWithPhone.length * 0.05).toFixed(2)} (${contactsWithPhone.length} SMS × €0.05)</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="sendBulkSMS('${formId}')" 
                                    class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-tremor-default font-medium transition-colors duration-200">
                                <i class="ri-send-plane-line mr-2"></i>Envoyer SMS
                            </button>
                            <button onclick="this.closest('.fixed').remove()" 
                                    class="px-6 py-3 border border-tremor-border text-tremor-content-emphasis rounded-tremor-default hover:bg-tremor-background-muted transition-colors duration-200">
                                Annuler
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(smsModal);
        }

        function bulkNewsletter(formId) {
            const selectedResponses = getSelectedResponses();
            if (selectedResponses.length === 0) {
                showNotification('Aucune réponse sélectionnée', 'warning');
                return;
            }

            const newsletterModal = document.createElement('div');
            newsletterModal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4';
            newsletterModal.innerHTML = `
                <div class="bg-white rounded-tremor-default shadow-tremor-dropdown max-w-lg w-full">
                    <div class="bg-purple-500 text-white p-6 rounded-t-tremor-default">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-semibold flex items-center">
                                <i class="ri-newsletter-line mr-2"></i>
                                Ajout à la newsletter
                            </h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-white/80 hover:text-white">
                                <i class="ri-close-line text-xl"></i>
                            </button>
                        </div>
                        <p class="text-white/80 mt-2">${selectedResponses.length} contact(s) à ajouter</p>
                    </div>
                    
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-tremor-content-strong mb-2">Newsletter</label>
                            <select id="newsletter-select" class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                                <option value="main">Newsletter Principale</option>
                                <option value="promo">Promotions & Offres</option>
                                <option value="tech">Actualités Techniques</option>
                                <option value="new" selected>Créer une nouvelle newsletter</option>
                            </select>
                        </div>
                        
                        <div id="new-newsletter-section" class="space-y-3">
                            <div>
                                <label class="block text-sm font-medium text-tremor-content-strong mb-2">Nom de la nouvelle newsletter</label>
                                <input type="text" id="newsletter-name" placeholder="Ex: Contacts FormEase 2025" 
                                       class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-tremor-content-strong mb-2">Description</label>
                                <textarea id="newsletter-description" rows="2" placeholder="Description de la newsletter..."
                                          class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none"></textarea>
                            </div>
                        </div>
                        
                        <div class="bg-purple-50 border border-purple-200 p-3 rounded-tremor-default">
                            <div class="flex items-center space-x-2">
                                <input type="checkbox" id="newsletter-welcome" class="w-4 h-4 text-purple-500" checked>
                                <label for="newsletter-welcome" class="text-sm text-purple-800">Envoyer un email de bienvenue</label>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="addToNewsletter('${formId}')" 
                                    class="flex-1 bg-purple-500 hover:bg-purple-600 text-white py-3 px-4 rounded-tremor-default font-medium transition-colors duration-200">
                                <i class="ri-add-line mr-2"></i>Ajouter
                            </button>
                            <button onclick="this.closest('.fixed').remove()" 
                                    class="px-6 py-3 border border-tremor-border text-tremor-content-emphasis rounded-tremor-default hover:bg-tremor-background-muted transition-colors duration-200">
                                Annuler
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(newsletterModal);
            
            // Gérer l'affichage conditionnel de la section nouvelle newsletter
            const newsletterSelect = document.getElementById('newsletter-select');
            const newNewsletterSection = document.getElementById('new-newsletter-section');
            
            newsletterSelect.addEventListener('change', function() {
                if (this.value === 'new') {
                    newNewsletterSection.style.display = 'block';
                } else {
                    newNewsletterSection.style.display = 'none';
                }
            });
        }

        function bulkArchive(formId) {
            const selectedResponses = getSelectedResponses();
            if (selectedResponses.length === 0) {
                showNotification('Aucune réponse sélectionnée', 'warning');
                return;
            }

            if (confirm(`Êtes-vous sûr de vouloir archiver ${selectedResponses.length} réponse(s) ?\n\nLes réponses archivées ne seront plus visibles dans la vue principale mais resteront accessibles dans les archives.`)) {
                
                showNotification(`Archivage de ${selectedResponses.length} réponse(s) en cours...`, 'info');
                
                // Simulation de l'archivage
                setTimeout(() => {
                    selectedResponses.forEach(checkbox => {
                        const row = checkbox.closest('tr');
                        if (row) {
                            row.style.transition = 'opacity 0.5s ease';
                            row.style.opacity = '0.5';
                            
                            // Ajouter un badge "Archivé"
                            const statusCell = row.querySelector('td:nth-last-child(2)');
                            if (statusCell) {
                                statusCell.innerHTML = '<span class="px-2 py-1 text-xs font-medium rounded-full bg-orange-100 text-orange-800">Archivé</span>';
                            }
                        }
                        checkbox.checked = false;
                    });
                    
                    updateSelectionCount(formId);
                    showNotification(`${selectedResponses.length} réponse(s) archivée(s) avec succès`, 'success');
                }, 1000);
            }
        }

        function bulkValidate(formId) {
            const selectedResponses = getSelectedResponses();
            if (selectedResponses.length === 0) {
                showNotification('Aucune réponse sélectionnée', 'warning');
                return;
            }

            const validationModal = document.createElement('div');
            validationModal.className = 'fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[60] p-4';
            validationModal.innerHTML = `
                <div class="bg-white rounded-tremor-default shadow-tremor-dropdown max-w-md w-full">
                    <div class="bg-emerald-500 text-white p-6 rounded-t-tremor-default">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-semibold flex items-center">
                                <i class="ri-check-line mr-2"></i>
                                Validation des réponses
                            </h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-white/80 hover:text-white">
                                <i class="ri-close-line text-xl"></i>
                            </button>
                        </div>
                        <p class="text-white/80 mt-2">${selectedResponses.length} réponse(s) à valider</p>
                    </div>
                    
                    <div class="p-6 space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-tremor-content-strong mb-2">Statut de validation</label>
                            <select id="validation-status" class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                <option value="validated">Validé</option>
                                <option value="approved">Approuvé</option>
                                <option value="verified">Vérifié</option>
                                <option value="completed">Traité</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-tremor-content-strong mb-2">Note de validation (optionnel)</label>
                            <textarea id="validation-note" rows="3" placeholder="Ajoutez une note de validation..."
                                      class="w-full p-3 border border-tremor-border rounded-tremor-default focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 resize-none"></textarea>
                        </div>
                        
                        <div class="bg-emerald-50 border border-emerald-200 p-3 rounded-tremor-default">
                            <div class="flex items-center space-x-2">
                                <input type="checkbox" id="notify-validation" class="w-4 h-4 text-emerald-500" checked>
                                <label for="notify-validation" class="text-sm text-emerald-800">Notifier les contacts par email</label>
                            </div>
                        </div>
                        
                        <div class="flex space-x-3">
                            <button onclick="validateResponses('${formId}')" 
                                    class="flex-1 bg-emerald-500 hover:bg-emerald-600 text-white py-3 px-4 rounded-tremor-default font-medium transition-colors duration-200">
                                <i class="ri-check-double-line mr-2"></i>Valider
                            </button>
                            <button onclick="this.closest('.fixed').remove()" 
                                    class="px-6 py-3 border border-tremor-border text-tremor-content-emphasis rounded-tremor-default hover:bg-tremor-background-muted transition-colors duration-200">
                                Annuler
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(validationModal);
        }

        // FONCTIONS D'EXÉCUTION DES ACTIONS
        function sendBulkEmail(formId) {
            const subject = document.getElementById('email-subject').value;
            const message = document.getElementById('email-message').value;
            const saveTemplate = document.getElementById('email-template').checked;
            
            if (!subject.trim() || !message.trim()) {
                showNotification('Veuillez remplir tous les champs requis', 'error');
                return;
            }
            
            const selectedCount = getSelectedResponses().length;
            
            // Fermer le modal
            document.querySelector('.z-\\[60\\]').remove();
            
            showNotification(`Envoi de ${selectedCount} emails en cours...`, 'info');
            
            // Simulation d'envoi progressif
            let sent = 0;
            const interval = setInterval(() => {
                sent++;
                if (sent <= selectedCount) {
                    showNotification(`Email ${sent}/${selectedCount} envoyé`, 'info');
                }
                
                if (sent >= selectedCount) {
                    clearInterval(interval);
                    showNotification(`✅ ${selectedCount} emails envoyés avec succès!`, 'success');
                    if (saveTemplate) {
                        showNotification('Modèle d\'email sauvegardé', 'info');
                    }
                    hideBulkActions(formId);
                }
            }, 500);
        }

        function sendBulkSMS(formId) {
            const message = document.getElementById('sms-message').value;
            
            if (!message.trim()) {
                showNotification('Veuillez saisir un message', 'error');
                return;
            }
            
            if (message.length > 160) {
                showNotification('Le message dépasse 160 caractères', 'error');
                return;
            }
            
            const selectedCount = getSelectedResponses().length;
            
            // Fermer le modal
            document.querySelector('.z-\\[60\\]').remove();
            
            showNotification(`Envoi de ${selectedCount} SMS en cours...`, 'info');
            
            // Simulation d'envoi
            setTimeout(() => {
                showNotification(`📱 ${selectedCount} SMS envoyés avec succès!`, 'success');
                showNotification(`Coût total: €${(selectedCount * 0.05).toFixed(2)}`, 'info');
                hideBulkActions(formId);
            }, 2000);
        }

        function addToNewsletter(formId) {
            const newsletterSelect = document.getElementById('newsletter-select').value;
            const newsletterName = document.getElementById('newsletter-name').value;
            const newsletterDescription = document.getElementById('newsletter-description').value;
            const sendWelcome = document.getElementById('newsletter-welcome').checked;
            
            if (newsletterSelect === 'new' && !newsletterName.trim()) {
                showNotification('Veuillez saisir le nom de la newsletter', 'error');
                return;
            }
            
            const selectedCount = getSelectedResponses().length;
            
            // Fermer le modal
            document.querySelector('.z-\\[60\\]').remove();
            
            if (newsletterSelect === 'new') {
                showNotification(`Création de la newsletter "${newsletterName}"...`, 'info');
                setTimeout(() => {
                    showNotification(`Newsletter "${newsletterName}" créée avec succès!`, 'success');
                }, 1000);
            }
            
            setTimeout(() => {
                showNotification(`📧 ${selectedCount} contact(s) ajouté(s) à la newsletter`, 'success');
                if (sendWelcome) {
                    showNotification(`Emails de bienvenue envoyés`, 'info');
                }
                hideBulkActions(formId);
            }, 1500);
        }

        function validateResponses(formId) {
            const status = document.getElementById('validation-status').value;
            const note = document.getElementById('validation-note').value;
            const notify = document.getElementById('notify-validation').checked;
            
            const selectedResponses = getSelectedResponses();
            const selectedCount = selectedResponses.length;
            
            // Fermer le modal
            document.querySelector('.z-\\[60\\]').remove();
            
            showNotification(`Validation de ${selectedCount} réponse(s) en cours...`, 'info');
            
            // Mettre à jour visuellement les réponses
            setTimeout(() => {
                selectedResponses.forEach(checkbox => {
                    const row = checkbox.closest('tr');
                    if (row) {
                        // Mettre à jour le statut dans le tableau
                        const statusCell = row.querySelector('td:nth-last-child(2)');
                        if (statusCell) {
                            const statusText = status.charAt(0).toUpperCase() + status.slice(1);
                            statusCell.innerHTML = `<span class="px-2 py-1 text-xs font-medium rounded-full bg-emerald-100 text-emerald-800">${statusText}</span>`;
                        }
                        
                        // Ajouter un effet visuel
                        row.style.backgroundColor = '#d1fae5';
                        setTimeout(() => {
                            row.style.backgroundColor = '';
                        }, 2000);
                    }
                    checkbox.checked = false;
                });
                
                updateSelectionCount(formId);
                showNotification(`✅ ${selectedCount} réponse(s) validée(s) avec succès!`, 'success');
                
                if (notify) {
                    showNotification(`Notifications envoyées aux contacts`, 'info');
                }
                
                if (note.trim()) {
                    showNotification(`Note de validation ajoutée`, 'info');
                }
            }, 1000);
        }

        function updateSMSCounter() {
            const textarea = document.getElementById('sms-message');
            const counter = document.getElementById('sms-counter');
            if (textarea && counter) {
                const length = textarea.value.length;
                counter.textContent = `${length}/160`;
                
                if (length > 160) {
                    counter.className = 'text-xs text-red-500 font-medium';
                    textarea.className = textarea.className.replace('focus:ring-green-500 focus:border-green-500', 'focus:ring-red-500 focus:border-red-500 border-red-300');
                } else {
                    counter.className = 'text-xs text-tremor-content-subtle';
                    textarea.className = textarea.className.replace('focus:ring-red-500 focus:border-red-500 border-red-300', 'focus:ring-green-500 focus:border-green-500');
                }
            }
        }

        function getSelectedResponses() {
            return Array.from(document.querySelectorAll('.response-checkbox:checked'));
        }

        function bulkAction(formId, action) {
            const selectedCount = document.querySelectorAll('.response-checkbox:checked').length;
            
            if (selectedCount === 0) {
                showNotification('Aucune réponse sélectionnée', 'warning');
                return;
            }
            
        function bulkAction(formId, action) {
            // Cette fonction est maintenant dépréciée, remplacée par des fonctions spécifiques
            console.log('Action en lot:', action, 'pour', formId);
            
            switch (action) {
                case 'email':
                    bulkEmail(formId);
                    break;
                case 'sms':
                    bulkSMS(formId);
                    break;
                case 'newsletter':
                    bulkNewsletter(formId);
                    break;
                case 'archive':
                    bulkArchive(formId);
                    break;
                case 'validate':
                    bulkValidate(formId);
                    break;
                default:
                    showNotification(`Action "${action}" non implémentée`, 'warning');
            }
        }

        // GESTION DYNAMIQUE DES NEWSLETTERS
        function createNewsletterFromForm(formId, formName) {
            const newsletterName = `Newsletter ${formName} - ${new Date().getFullYear()}`;
            const description = `Newsletter automatiquement créée pour les réponses du formulaire "${formName}"`;
            
            // Simulation de création de newsletter
            setTimeout(() => {
                showNotification(`Newsletter "${newsletterName}" créée automatiquement`, 'success');
            }, 500);
            
            return {
                id: `newsletter-${formId}-${Date.now()}`,
                name: newsletterName,
                description: description,
                created: new Date().toISOString(),
                subscribers: 0
            };
        }

        // GESTION AVANCÉE DES MODÈLES D'EMAIL
        function saveEmailTemplate(subject, message, formId) {
            const template = {
                id: `template-${formId}-${Date.now()}`,
                name: `Modèle ${subject}`,
                subject: subject,
                message: message,
                formId: formId,
                created: new Date().toISOString()
            };
            
            // Sauvegarder dans localStorage pour la démo
            const templates = JSON.parse(localStorage.getItem('emailTemplates') || '[]');
            templates.push(template);
            localStorage.setItem('emailTemplates', JSON.stringify(templates));
            
            return template;
        }

        function loadEmailTemplates(formId) {
            const templates = JSON.parse(localStorage.getItem('emailTemplates') || '[]');
            return templates.filter(t => t.formId === formId || !t.formId);
        }

        // FONCTIONS D'AMÉLIORATION UX
        function animateActionSuccess(action, count) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-500 text-white p-4 rounded-tremor-default shadow-tremor-dropdown z-[70] transform translate-x-full transition-transform duration-300';
            notification.innerHTML = `
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
                        <i class="ri-check-line text-lg"></i>
                    </div>
                    <div>
                        <p class="font-medium">Action terminée</p>
                        <p class="text-sm text-green-100">${action} - ${count} élément(s)</p>
                    </div>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animation d'entrée
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            // Animation de sortie
            setTimeout(() => {
                notification.style.transform = 'translateX(full)';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 4000);
        }

        // Fonctions utilitaires pour les actions
        }

        // Fonctions utilitaires pour les actions
        function toggleSelectAll(formId) {
            console.log('Toggle select all pour:', formId);
            showNotification('Sélection de tous les éléments', 'info');
        }

        function bulkAction(action) {
            showNotification('Action en lot: ' + action, 'success');
            console.log('Action en lot:', action);
        }

        function viewResponse(id) {
            showNotification('Affichage de la réponse #' + id, 'info');
        }

        function editResponse(id) {
            showNotification('Modification de la réponse #' + id, 'info');
        }

        // Dropdown toggle functionality
        function toggleDropdown(id) {
            const dropdown = document.getElementById(id);
            const allDropdowns = document.querySelectorAll('[id^="form"]');
            
            // Close all other dropdowns
            allDropdowns.forEach(dd => {
                if (dd.id !== id) {
                    dd.classList.add('hidden');
                }
            });
            
            // Toggle current dropdown
            dropdown.classList.toggle('hidden');
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('[onclick^="toggleDropdown"]')) {
                const allDropdowns = document.querySelectorAll('[id^="form"]');
                allDropdowns.forEach(dd => dd.classList.add('hidden'));
            }
        });

        // Navbar background on scroll
        window.addEventListener('scroll', function() {
            const nav = document.querySelector('nav');
            if (window.scrollY > 100) {
                nav.classList.add('bg-white', 'shadow-md');
                nav.classList.remove('bg-white/95');
            } else {
                nav.classList.remove('bg-white', 'shadow-md');
                nav.classList.add('bg-white/95');
            }
        });
    </script>
</body>
</html>
